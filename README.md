# TestWork0005

## Алгоритм решения задачи


Определить требования к продакшну, какая аппаратная часть и какая скорость работы требуется

Перед выполнением задачи надо проанализировать датасет. В случае поставленной задачи критерии для анализа - это количество кадров в видео и количество примеров

Далее важно определить архитектуру модели, для этого надо сделать ресерч существующих моделей. Определить метрики, по которым возможно будет оценить работу модели. 

После такого ресерча выбрать оптимальные и поставить эксперименты для разных моделей. 

После обучения и выбора лучшей модели - оптимизировать и привести к продакшн формату(добавить возможность конвертирования сырых данных к формату входа сети, тоже самое сделать для выхода)

## Подробное описание

Определение требований к скорости работы, определение аппаратной части продакшн сервера. На основе этих данных проектировать модель. Подумать над метриками для оценки работы всей системы.

При выборе модели важно провести ресерч существующих архитектур, к моделям относящимся к данной области можно отнести: Video-LLama, video2text на основе рекуррентной сети, VideoCLIP, Test of time, также two-stream модели, 3д сверточные сети. Также возможно для лучшей работы комбинирование таких моделей как action-recognition, detection и тд. 

Проанализировать датасет, определить количество данных, разбить их на обучающую выборку, тестовую и валидационую 
Начать эксперименты с готовых архитектур, например такой как Video-Llama, ее архитектура состоит из vision-transformer(что позволяет ей легко работать с видео данными), а также она имеет возможность обрабатывать звук. Возможно взять саму идею за основу, но при этом выбрать небольшие предобученые модели, особенно языковую модель. Также как вариант поэкспериментировать с обученными на видео визуал трансформерами соединенными с предобученными языковыми моделями. Выбрать метрики для оценки сети. Добавить аугментации для данных.

Во время экспериментов определить достаточно ли примеров в  выборки и в худшем случае разметить новые данные. 
Повторить эксперименты, возможно добавить в архитектуру дополнительные feature экстракторы в виде голов от моделей для детекции и action recognition и тд. 
После получения готовой модели - оптимизировать ее с помощью различных фреймворков, например Nvidia triton.

Если модель предсказывает только описание, то добавить простые модели для генерации тегов и названий (на основе небольшого трансформера)
Добавить конвертацию сырых данных с сервера в формат сети, а также выходы сети конвертировать в формат для сервера.

Тестирование на данных с продакшна, также, как вариант, добавить в продакшне возможность оценки названий, описания и тегов самими пользователями, что позволит определить моменты, где модель ошибается, а также дополнить датасет с хорошими примерами(на основе оценок пользователей), которые выдала сама модель.

## Возможные сложности:
Проблемы с аппаратной частью, например нехватка видео-памяти для инференса модели, даже после оптимизаций, в этом случае нужно уменьшать модели. Но как правило определить размер занимаемой памяти и скорость работы сети можно и до обучения.

Проблема с нехваткой данных в датасете или же нерепрезентативность этих данных. В первом случае модель будет быстро переобучаться, а во втором случае на продакшне будет выдавать плохие результаты в случае сильного отличия данных. В первом случае, проблему можно решить с помощью дополнительных данных. Во втором же случае - эту проблему можно будет определить заранее ручной проверкой датасета на предмет того, насколько разные по тематике видео и их описания. Либо же прибегнуть к каким-нибудь предобученным языковым моделям, которые смогут кластеризовать данные по категориям (или использовать ивристические методы на основе анализа текста), таким образом можно будет определить каких категорий больше, а каких меньше и лучше распределять данные во время обучения. 
